# Кафедра информатики. Гламаздин И.И.

## Лабораторная работа № 12
### Разработка веб-приложений с использованием Blazor WebAssembly и SignalR

#### 1. Цель работы
- Изучение технологии Blazor WebAssembly для создания клиентских веб-приложений
- Освоение технологии SignalR для реализации взаимодействия в реальном времени
- Получение практических навыков разработки полнофункциональных веб-приложений

#### 2. Задача работы
- Создание проекта Blazor WebAssembly с аутентификацией через удаленный сервер
- Реализация взаимодействия с API для получения и обработки данных
- Разработка онлайн-игры с использованием технологии SignalR для взаимодействия в реальном времени

#### 3. Общие сведения
Blazor WebAssembly - это технология Microsoft для создания интерактивных веб-приложений, где код C# выполняется непосредственно в браузере. SignalR - библиотека для реализации двусторонней связи в реальном времени между клиентом и сервером.

#### 4. Выполнение работы

##### 4.1. Исходные данные
Используйте проект из предыдущих лабораторных работ.

##### 4.2. Подготовка проекта
1. Добавьте в решение новый проект - приложение Blazor WebAssembly Standalone App
2. Назначьте проекту имя XXX.BlazorWasm
3. Выберите аутентификацию с помощью индивидуальных учетных записей
4. Изучите структуру созданного проекта:
   - Файл Program.cs с регистрацией компонентов
   - Файл appsettings.json в папке wwwroot
   - Корневой компонент app.razor
   - Главную страницу index.html

##### 4.3. Настройка аутентификации через Keycloak
1. Добавьте нового клиента в Keycloak для вашего приложения
2. Настройте подключение к Keycloak в файлах appsettings.json
3. Зарегистрируйте OIDC аутентификацию в Program.cs
4. Проверьте работу аутентификации

##### 4.4. Задание №1. Интеграция с API
Создайте страницу для отображения списка объектов вашей предметной области с получением данных через API.

**Рекомендации:**
- Используйте метод OnInitializedAsync для загрузки данных
- Настройте маршрутизацию к странице
- Добавьте пункт меню для навигации

##### 4.5. Задание №2. Создание сервиса доступа к данным
Разработайте сервис для работы с API:

```csharp
public interface IDataService
{
    event Action DataLoaded;
    List<Category> Categories { get; set; }
    List<Dish> Dishes { get; set; }
    bool Success { get; set; }
    string ErrorMessage { get; set; }
    int TotalPages { get; set; }
    int CurrentPage { get; set; }
    Category SelectedCategory { get; set; }
    
    Task GetProductListAsync(int pageNo = 1);
    Task GetCategoryListAsync();
}
```

**Требования:**
- Реализуйте класс DataService
- Настройте базовый адрес HttpClient
- Используйте QueryString для параметров запроса
- Зарегистрируйте сервис как Scoped

##### 4.6. Задание №3. Авторизация с использованием JWT
1. Запретите неавторизованный доступ к API методам
2. Настройте получение и использование JWT токена
3. Реализуйте авторизацию на стороне клиента

##### 4.7. Задание №4. Разработка компонентов пользовательского интерфейса
Создайте компоненты для:
1. Отображения списка объектов (DishesList)
2. Выбора категории (CategorySelector)
3. Пагинации (Pager)
4. Детальной информации об объекте (DishDetails)

##### 4.8. Задание №5. Онлайн-игра с использованием SignalR
Разработайте многопользовательскую онлайн-игру с соблюдением следующих требований:

**Обязательные требования:**
- Количество игроков: не менее 2
- Бизнес-логика игры реализуется на сервере
- Использование строго типизированного SignalR Hub
- Поддержка нескольких одновременных игр (свойство Group)
- Клиентская часть на основе Blazor WebAssembly
- Отдельные классы для бизнес-логики клиента и сервера
- Компонент Blazor для отрисовки игрового поля

**Варианты заданий:**
1. Нарды (игра в камни)
2. Чак-э-лак (Chuck-a-Luck) - игра в кости
3. Калах (игра в камни)
4. Блэк Джек – игра в карты
5. Реверси
6. Перудо - игра в кости
7. Крестики-нолики на поле 5х5
8. Бак-дайс (Buck dice) - игра в кости
9. Бура – игра в карты
10. Свинья - игра в кости
11. Двадцать одно – игра в карты
12. Тузы (Aces) – игра в кости

**Более сложные варианты:**
- Блеф (Bluff) - игра в кости
- Яхта (Yacht) - игра в кости
- Зонк (Zonk, Farkle) - игра в кости
- Морской бой
- Тысяча – игра в карты
- Тысяча – игра в кости
- Покер на костях

##### 4.9. Организация работы
1. Разбейтесь на команды (до 5 человек)
2. Выберите старшего для координации
3. Распределите задачи между участниками:
   - Разработка клиентской логики
   - Разработка серверной логики
   - Проектирование интерфейса
   - Реализация бизнес-логики игры
4. При защите укажите вклад каждого участника

#### 5. Контрольные вопросы
1. В какой вид компилируется клиентский код приложения Blazor WebAssembly?
2. Чем отличается одностраничное приложение (SPA) от обычного веб-приложения?
3. Что такое CascadingParameter и как его использовать?
4. Как в родительском компоненте обработать событие дочернего компонента?
5. Для чего используется метод StateHasChanged?
6. Как работает компонент `<AuthorizeView/>`?
7. Каковы преимущества использования SignalR перед обычными HTTP запросами?
8. Как организовать групповое взаимодействие в SignalR?
9. Как ограничить доступ неавторизованных пользователей к страницам Blazor?
10. Какие механизмы обеспечивают безопасность при работе с SignalR?

#### 6. Критерии оценки
1. Корректная работа аутентификации через Keycloak
2. Успешная интеграция с API и отображение данных
3. Функциональность всех разработанных компонентов
4. Работоспособность онлайн-игры
5. Качество кода и архитектурные решения
6. Полнота реализации бизнес-логики игры
7. Качество документации и презентации проекта

**Время выполнения работы:** 12 часов (6 занятий)